<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>collab-frontend</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="./js/main.js" defer></script>
    <script src="./js/api-data.js" defer></script>
  </head>
  <body>
    <div class="head-fixed">
      <div class="head-flex">
        <div class="head-left header-font">
          collab-frontend
        </div>
        <div class="head-right">
          <span id="headerName"></span>
          <span id="headerLoginButton" hidden>
            <a href="/login"><button>Login</button></a>
          </span>
          <a href="/logout"><button>Logout</button></a>
        </div>
      </div>
    </div>

    <div class="scrollable-div">

      <div class="center">
        <img class="image" src="images/home-network-oauth2.png" alt="home network oauth2 network" width="1010" height="587">
      </div>

      <h3>Try the API</h3>

      <div class="description-contents">
        <p>
          It is a good assumption you have the mock web server (collab-frontend)
          running, or you would not see this page.
        </p>
        <p>
          It is also a good assumption that the login and logout buttons are
          working. This indicates the authorization server is working (collab-auth).
        </p>
        <p>
          If the mock database is running (collab-backend-api), pressing this
          [Fetch Data] button will generate an API query request.
          The web server will add the users access token.
          If the token is successfully validated by the mock API,
          then the API will return an array and it will be displayed.
        </p>
        <p>
          If the mock IOT device is also running (collab-iot-device),
          the IOT device will periodically submit emulated data to the mock database
          using a timer.
          If the mock IOT device is not running, or it is unable to
          obtain a valid client access_token,
          then the mock API will contain no data and an empty array will be displayed [ ].
        </p>
      </div>

      <div class='button-div'>
        <button id="clearDisplayButton">Clear</button>
        <button id="iotDataButton">Fetch Data</button>
        <span>GET /api/v1/data/iot-data/</span>
      </div>
      <div class='button-div'>
      </div>
      <div class="info-div" >
        <pre id="apiDataText"></pre>
        <div class="error-text" id="apiErrorText"></div>
      </div>

      <h3>Interspect Endpoint</h3>
      <div class="description-contents">
        <p>
          This button is for demonstration purposes only.
          Normally a user would never possess an access_token, and
          therefore never have the need to validate a token.
          In the frontend web server, there is a temporary development route
          &quot;/proxy/oauth/introspect&quot that will submit the users's
          access_token to the authorization server
          &quot;/oauth/introspect&quot; route.
          The introspect endpoint validates the token and returns various
          information about the user's access_token that was submitted.
          It is included here to show example response content.
          The typical useful properties are: <b>active, scope, and user</b>.
        </p>
      </div>

      <div class='button-div'>
        <button id="clearIntrospectButton">Clear</button>
        <button id="introspectButton">Fetch Data</button>
        <span>/proxy/oauth/introspect</span>
      </div>
      <div class="info-div" >
        <pre id="introspectText"></pre>
        <div class="error-text" id="introspectErrorText"></div>
      </div>

      <h3>Userinfo Endpoint</h3>
        <div class="description-contents">
        <p>
          The <b>/userinfo</b> endpoint is intended for use in determining
          user's current login status.
          The response includes the logged in user name for display on the page (see header above)
        </p>
      </div>
      <div class='button-div'>
        <button id="clearUserinfoButton">Clear</button>
        <button id="userinfoButton">Fetch Data</button>
        <span>/userinfo (for update page header)</span>
      </div>
      <div class="info-div" >
        <pre id="userinfoText"></pre>
        <div class="error-text" id="userinfoErrorText"></div>
      </div>

      <h3>User Password Change</h3>
        <div class="description-contents">
        <p>
          A web page will typically include a link that the user may use to
          change their user password. In this case, the frontend web server
          will accept the /changepassword route and redirect (302) to the
          authorization server.
        </p>
      </div>
      <div class='button-div'>
        <a href="/changepassword"><button>Change Password</button></a>
        <span>/changepassword will redirect to authorization server.</span>
      </div>

      <div class="footer">
        Collab-frontend demo page.
      </div>
    <div>
  </body>
</html>
